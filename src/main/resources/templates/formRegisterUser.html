<!DOCTYPE html>
<html lang="it">

<head th:replace="~{fragments/header :: header(title='SiwFood - Inserimento Cuoco')}"></head>

<body>
	<!-- Include la navbar -->
	<div th:if="${ruolo == 'ADMIN'}">
		<div th:replace="~{fragments/navbar :: navbar}"></div>
	</div>
	<div class="container form-container mt-5 mb-5">
		<div class="card-header">
			<h2 class="text-center mb-4">Registrazione</h2>
		</div>

		<form th:action="@{/register}" method="post" enctype="multipart/form-data" th:object="${credentials}">

			<div th:if="${#fields.hasGlobalErrors()}" class="alert alert-danger text-center" role="alert">
				<p th:each="err : ${#fields.globalErrors()}" th:text="${err}" class="mb-0">...</p>
			</div>

			<div class="row">
				<!-- Colonna Immagine -->
				<div class="col-md-4">
					<div class="card mb-4">
						<div class="card-header">
							<h5 class="card-title mb-0">Immagine Utente</h5>
						</div>
						<div class="card-body p-0">
							<div class="image-container">
								<img src="/images/default/senzaFoto.jpeg" class="rounded img-lg" alt="Immagine Utente"
									id="utenteImagePreview" />
							</div>
						</div>
					</div>
				</div>

				<div class="col-md-8">
					<div class="row">
						<!-- Colonna Inserimento Dati -->
						<div class="col-md-6">
							<div class="mb-3">
								<label for="name" class="form-label">Nome</label>
								<input type="text" class="form-control" id="name" name="name" required>
								<span th:if="${#fields.hasErrors('user.name')}" th:errors="${user.name}"
									th:style="'color:red'"></span>
							</div>
							<div class="mb-3">
								<label for="surname" class="form-label">Cognome</label>
								<input type="text" class="form-control" id="surname" name="surname" required>
								<span th:if="${#fields.hasErrors('user.surname')}" th:errors="${user.surname   }"
									th:style="'color:red'"></span>
							</div>
							<div class="mb-3">
								<label for="dateOfBirth" class="form-label">Data di Nascita</label>
								<input type="date" class="form-control" id="dateOfBirth" name="dateOfBirth" required>
							</div>
							<div class="mb-3">
								<label for="fileImage" class="form-label">Carica una foto del cuoco (opzionale)</label>
								<input type="file" class="form-control" id="fileImage" name="fileImage" accept="image/*"
									onchange="loadFile(event)">
								<div class="form-text text-light">Assicurati di caricare una foto chiara e recente del cuoco.
								</div>
							</div>
						</div>

						<!-- Colonna Dati di Accesso -->
						<div class="col-md-6">
							<div class="mb-3">
								<label for="username" class="form-label">Username</label>
								<input type="text" class="form-control" id="username" name="username" required>
							</div>
							<div class="mb-3">
								<label for="email" class="form-label">Email</label>
								<input type="email" class="form-control" id="email" name="email" required>
							</div>
							<div class="mb-3">
								<label for="password" class="form-label">Password</label>
								<div class="input-group">
									<input type="password" class="form-control" id="password" name="password" required>
									<button type="button" class="btn btn-outline-secondary" id="togglePassword">
										<i class="bi bi-eye"></i>
									</button>
								</div>
							</div>
							<div class="mb-3">
								<label for="confirmPassword" class="form-label">Conferma Password</label>
								<div class="input-group">
									<input type="password" class="form-control" id="confirmPassword" name="confirmPassword"
										required>
									<button type="button" class="btn btn-outline-secondary" id="toggleConfirmPassword">
										<i class="bi bi-eye"></i>
									</button>
								</div>
							</div>
						</div>
					</div>
					<!-- Pulsante di Conferma -->
					<div class="row mt-3">
						<div class="col-md-12">
							<button type="submit" class="btn btn-primary w-100">Conferma</button>
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>

	<!-- Script per la preview dell'immagine -->
	<script>
		function loadFile(event) {
			var image = document.getElementById('utenteImagePreview');
			image.src = URL.createObjectURL(event.target.files[0]);
		}

		document.getElementById('togglePassword').addEventListener('click', function () {
			var passwordField = document.getElementById('password');
			var passwordFieldType = passwordField.getAttribute('type');
			if (passwordFieldType === 'password') {
				passwordField.setAttribute('type', 'text');
				this.innerHTML = '<i class="bi bi-eye-slash"></i>';
			} else {
				passwordField.setAttribute('type', 'password');
				this.innerHTML = '<i class="bi bi-eye"></i>';
			}
		});

		document.getElementById('toggleConfirmPassword').addEventListener('click', function () {
			var confirmPasswordField = document.getElementById('confirmPassword');
			var confirmPasswordFieldType = confirmPasswordField.getAttribute('type');
			if (confirmPasswordFieldType === 'password') {
				confirmPasswordField.setAttribute('type', 'text');
				this.innerHTML = '<i class="bi bi-eye-slash"></i>';
			} else {
				confirmPasswordField.setAttribute('type', 'password');
				this.innerHTML = '<i class="bi bi-eye"></i>';
			}
		});
	</script>
</body>

</html>
